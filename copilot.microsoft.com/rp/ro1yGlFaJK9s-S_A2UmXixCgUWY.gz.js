var SydneyExternalSerpResources;(function(){function r(r){var s,h,c,l,a,v,f=JSON.parse(r),o,y,w;if(f&&f.answerType==="ads"){if(!f.fetchUrl||!(f.fetchUrl.startsWith("/BingChatAdsFetch")||f.fetchUrl.startsWith("/turing/BingChatAdsFetch"))){SydFSCHelper.SydLog("AdsAjax","BingChatAds","RenderChatAdsCallFailed",{Reason:"Invalid fetch URL sent from client"});return}if(_w.ifidmap){if(_w.ifidmap.includes(f.iframeId)){SydFSCHelper.SydLog("AdsAjax","BingChatAds","RenderChatAdsCallFailed",{Reason:"Ad already requested for iframeId"});return}_w.ifidmap.push(f.iframeId)}else _w.ifidmap=[f.iframeId];o=f.fetchUrl.startsWith("/turing/BingChatAdsFetch")?f.fetchUrl:"/turing"+f.fetchUrl;y=SydFSCHelper.getConfigOrDefault((s=_w._sydConvConfig)===null||s===void 0?void 0:s.isUnderside,!1);y&&(o="/edgesvc"+o);var e=new URL(o,_w.location.origin),p=(c=(h=e===null||e===void 0?void 0:e.searchParams)===null||h===void 0?void 0:h.get(t))!==null&&c!==void 0?c:"",b=(a=(l=e===null||e===void 0?void 0:e.searchParams)===null||l===void 0?void 0:l.get(i))!==null&&a!==void 0?a:"",k=SydFSCHelper.getConfigOrDefault((v=_w._sydConvConfig)===null||v===void 0?void 0:v.isVisualParityRun,!1);if(p===""&&!k){SydFSCHelper.SydLog("AdsAjax","BingChatAds","Could not parse query from request");return}if(e.searchParams["delete"](t),e.searchParams["delete"](i),w="".concat(t,"=").concat(encodeURIComponent(p),"&").concat(i,"=").concat(encodeURIComponent(b)),o=e.pathname+e.search,!f.singleSlotName){SydFSCHelper.SydLog("AdsAjax","BingChatAds","RenderChatAdsCallFailed",{Reason:"SingleSlotName not set"});return}if(!f.adsFrameSource){SydFSCHelper.SydLog("AdsAjax","BingChatAds","No client source to attach ads to from client");return}function d(t,i){var r,u,o,s;if(t&&n!==null&&i){if(i.appendTo(n),!n.children||n.children.length===0){SydFSCHelper.SydLog("AdsAjax","BingChatAds","No ads in response to process");return}s=(o=(u=(r=e.searchParams)===null||r===void 0?void 0:r.get("codex_src"))===null||u===void 0?void 0:u.includes("semanticserp"))!==null&&o!==void 0?o:!1;SydFSCHelper.injectExternalAd(f.adsFrameSource,f.iframeId,s)&&SydFSCHelper.SydLog("AdsAjax","BingChatAds","Injection Succeeded")}else SydFSCHelper.SydLog("AdsAjax","BingChatAds","InjectionFailed",{Reason:"Ajax call did not return a success code",Url:e})}u(o,w,{callback:d,headers:{"chat-single-slot-name":f.singleSlotName}})}else SydFSCHelper.SydLog("AdsAjax","BingChatAds","RenderChatAdsCallFailed",{Reason:"Invalid JSON from client or event is not of type 'Ads'"})}function u(n,t,i){function l(){r[e]=c;r.abort&&r.abort()}function h(n,t){typeof n=="function"&&n(t,{request:r,appendTo:function(n){r&&typeof sj_appHTML!="undefined"&&sj_appHTML(n,r.responseText)}})}var u,r=sj_gx(),e="onreadystatechange",f,o=null,s,a=sb_st,v=sb_ct,c=function(){};if(!n||!r){h(u,!1);return}r.open("post",n,!0);r.setRequestHeader("Content-type","application/x-www-form-urlencoded");i&&(u=i.callback,f=i.timeout,s=i.headers,Object.keys(s||{}).forEach(function(n){r.setRequestHeader(n,s[n])}),i.withCredentials!==undefined&&(r.withCredentials=i.withCredentials));r[e]=function(){if(r.readyState===4){var n=!1;o!==null&&v(o);r.status===200&&(n=!0,r[e]=c);h(u,n)}};sj_evt.bind("ajax.unload",l);r.send(t);f&&f>0&&(o=a(function(){l();h(u,!1)},f))}function f(){n=_d.getElementById("b_chat_external_content");_w._sydExtRes=r}var n,t="q",i="codex_summ";f()})(SydneyExternalSerpResources||(SydneyExternalSerpResources={}))